import pandas as pd
from sklearn.datasets import load_breast_cancer
from sklearn.model_selection import train_test_split,GridSearchCV
from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler
from sklearn.svm import SVC
from sklearn.metrics import accuracy_score,precision_score,recall_score,f1_score

data=load_breast_cancer()
X=pd.DataFrame(data.data,columns=data.feature_names)
y=pd.Series(data.target)

X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=42,stratify=y)

default_pipeline=Pipeline([
    ("scaler",StandardScaler()),
    ("model",SVC())
])

default_pipeline.fit(X_train,y_train)
y_pred_default=default_pipeline.predict(X_test)

param_grid={
    "model__C":[0.1,1,10],
    "model__kernel":["linear","rbf"],
    "model__gamma":["scale","auto"]
}

tuned_pipeline=Pipeline([
    ("scaler",StandardScaler()),
    ("model",SVC())
])

grid=GridSearchCV(tuned_pipeline,param_grid,cv=5,scoring="f1")
grid.fit(X_train,y_train)

best_model=grid.best_estimator_
y_pred_best=best_model.predict(X_test)

print("Best Parameters:",grid.best_params_)

comparison=pd.DataFrame({
    "Model":["Default SVM","Tuned SVM"],
    "Accuracy":[accuracy_score(y_test,y_pred_default),accuracy_score(y_test,y_pred_best)],
    "Precision":[precision_score(y_test,y_pred_default),precision_score(y_test,y_pred_best)],
    "Recall":[recall_score(y_test,y_pred_default),recall_score(y_test,y_pred_best)],
    "F1 Score":[f1_score(y_test,y_pred_default),f1_score(y_test,y_pred_best)]
})

comparison
